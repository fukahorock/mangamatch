<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <title>MangaMatch｜作画募集カタログ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Bootstrap 5 (CDN) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
  <style>
    body{background:#f8f9fa; padding-bottom:120px;}
    .mm-card{transition:box-shadow .15s ease;}
    .mm-card:hover{box-shadow:0 .25rem .75rem rgba(0,0,0,.08);}
    .mm-chip{display:inline-block;padding:.25rem .5rem;border-radius:999px;font-size:.75rem;background:#f1f3f5;margin-right:.25rem;margin-bottom:.25rem;cursor:pointer;}
    .mm-chip:hover{background:#e9ecef;}
    .mm-label{font-size:.82rem;color:#6c757d;}
    .mm-note{white-space:pre-wrap;}
    .mm-stickybar{position:fixed;left:0;right:0;bottom:0;z-index:1030;display:none}
    .avatar{width:36px;height:36px;border-radius:50%;object-fit:cover}
    @media (min-width: 992px){ .content-with-nav{display:grid;grid-template-columns:1fr 280px;gap:24px;} }
    .badge-closed { background: #6c757d !important; }
  </style>
</head>
<body>

  <!-- Topbar -->
  <nav class="navbar navbar-light bg-white border-bottom sticky-top">
    <div class="container d-flex align-items-center justify-content-between">
      <div class="d-flex align-items-center gap-3">
        <button class="navbar-toggler d-lg-none" type="button"
                data-bs-toggle="offcanvas" data-bs-target="#navOffcanvas" aria-controls="navOffcanvas"
                aria-label="メニューを開く">
          <span class="navbar-toggler-icon"></span>
        </button>
        <span class="navbar-brand fw-bold mb-0">MangaMatch</span>
        <span class="text-muted small d-none d-md-inline">知人限定・ポートフォリオ不要</span>
      </div>
      <div class="d-flex align-items-center gap-2">
        <img src="https://unavatar.io/discord" class="avatar" alt="Discord Avatar (placeholder)">
        <div class="small text-muted">あなた：<span id="userName">（未ログイン）</span></div>
      </div>
    </div>
  </nav>

  <main class="container my-4 content-with-nav">
    <!-- メイン列 -->
    <section>
      <!-- 上部フィルタ列 -->
      <div class="row g-2 mb-2">
        <div class="col-12 col-xl-5">
          <input id="searchInput" class="form-control" placeholder="フリーワード検索（タイトル・タグ・雑誌・頻度/ページ数・向いてそうな人・内容）" />
        </div>
        <div class="col-6 col-md-4 col-xl-3">
          <select id="filterProgress" class="form-select">
            <option value="">進捗状況（すべて）</option>
            <option value="連載決定済み">連載決定済み</option>
            <option value="コンペ用ネーム準備中">コンペ用ネーム準備中</option>
            <option value="一緒につくろう企画段階">一緒につくろう企画段階</option>
            <option value="アイデアだけある">アイデアだけある</option>
            <option value="募集終了">募集終了</option>
          </select>
        </div>
        <div class="col-6 col-md-4 col-xl-2">
          <!-- 新規：更新日ソート -->
          <select id="sortOrder" class="form-select" aria-label="更新日の並び替え">
            <option value="desc">更新日：新しい順</option>
            <option value="asc">更新日：古い順</option>
          </select>
        </div>
        <div class="col-6 col-md-4 col-xl-2">
          <!-- 新規：表示件数プルダウン -->
          <select id="pageSize" class="form-select" aria-label="1ページの表示件数">
            <option value="6">6件表示</option>
            <option value="12">12件表示</option>
            <option value="24">24件表示</option>
            <option value="all">全件表示</option>
          </select>
        </div>
        <div class="col-6 col-xl-0 d-grid">
          <button id="clearFilters" class="btn btn-outline-secondary">絞り込み解除</button>
        </div>
      </div>

      <!-- タグ絞り込みインジケータ -->
      <div id="activeTagBar" class="mb-3 d-none">
        <span class="small me-2 text-muted">タグで絞り込み中：</span>
        <span id="activeTag" class="badge text-bg-dark me-2"></span>
        <button id="clearTagBtn" class="btn btn-sm btn-outline-secondary">タグ解除</button>
      </div>

      <!-- 一覧 -->
      <div id="list" class="row g-3"></div>
      <div id="empty" class="text-center text-muted py-5 d-none">該当する作品がありません。</div>

      <!-- ページネーション -->
      <nav class="mt-3 d-flex justify-content-center">
        <ul id="pager" class="pagination"></ul>
      </nav>
    </section>

    <!-- 右ナビ -->
    <aside class="d-none d-lg-block">
      <div class="card">
        <div class="card-body">
          <div class="d-flex align-items-center gap-2 mb-3">
            <img src="https://unavatar.io/discord" class="avatar" alt="">
            <div class="small">
              <div class="text-muted">あなた</div>
              <div id="userNameSide" class="fw-semibold">（未ログイン）</div>
            </div>
          </div>
          <ul class="list-unstyled mb-0">
            <li class="mb-2"><a href="#" class="link-dark">トップ（作品一覧）</a></li>
            <li class="mb-2"><a href="#" class="link-dark">使い方</a></li>
            <li class="mb-2"><a href="#" class="link-dark">よくある質問</a></li>
            <li class="mb-2"><a href="#" class="link-dark">お問い合わせ</a></li>
          </ul>
          <hr>
          <div class="small text-muted">※ 原稿料は企画により異なるため掲載しません。詳細は個別にご相談ください（備考欄をご参照）。</div>
        </div>
      </div>
    </aside>
  </main>

  <!-- オフキャンバス（スマホのナビ） -->
  <div class="offcanvas offcanvas-start" tabindex="-1" id="navOffcanvas" aria-labelledby="navOffcanvasLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="navOffcanvasLabel">ナビゲーション</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="閉じる"></button>
    </div>
    <div class="offcanvas-body">
      <div class="d-flex align-items-center gap-2 mb-3">
        <img src="https://unavatar.io/discord" class="avatar" alt="">
        <div class="small">
          <div class="text-muted">あなた</div>
          <div id="userNameOff" class="fw-semibold">（未ログイン）</div>
        </div>
      </div>
      <ul class="list-unstyled mb-0">
        <li class="mb-2"><a href="#" class="link-dark" data-bs-dismiss="offcanvas">トップ（作品一覧）</a></li>
        <li class="mb-2"><a href="#" class="link-dark" data-bs-dismiss="offcanvas">使い方</a></li>
        <li class="mb-2"><a href="#" class="link-dark" data-bs-dismiss="offcanvas">よくある質問</a></li>
        <li class="mb-2"><a href="#" class="link-dark" data-bs-dismiss="offcanvas">お問い合わせ</a></li>
      </ul>
    </div>
  </div>

  <!-- 下部：選択バー -->
  <div id="stickyBar" class="mm-stickybar bg-white border-top">
    <div class="container py-3 d-flex flex-wrap gap-2 align-items-center justify-content-between">
      <div class="small">気になってる作品: <span id="count" class="fw-bold">0</span> 件</div>
      <button id="openModalBtn" class="btn btn-primary">選んでフカホリに伝える</button>
    </div>
  </div>

  <!-- モーダル -->
  <div class="modal fade" id="submitModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog">
      <form id="submitForm" class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">フカホリに伝える（まとめて）</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="閉じる"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label class="form-label">フカホリへのメッセージ（任意）</label>
            <textarea class="form-control" id="noteCommon" rows="3" placeholder="例）この2本なら来月から動けます。"></textarea>
          </div>
          <div class="border rounded p-2">
            <div class="small text-muted mb-2">各作品に「一言コメント」を追加できます（任意）</div>
            <div id="selectedList" class="vstack gap-2"></div>
          </div>
        </div>
        <div class="modal-footer">
          <button id="submitBtn" class="btn btn-primary" type="submit">送信（いまはconsole出力）</button>
        </div>
      </form>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
  <script src="app.js"></script>
</body>
</html>
